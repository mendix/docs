language: ruby
rvm:
- 2.3.1

env:
  global:
  - TRAVIS_NODE_VERSION="6.9.1"
  - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
  - JEKYLL_ENV=production

install:
  - rm -rf ~/.nvm && git clone https://github.com/creationix/nvm.git ~/.nvm && (cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`) && source ~/.nvm/nvm.sh && nvm install $TRAVIS_NODE_VERSION
  - npm install -g gulp
  - npm install

script:
  #- bundle exec jekyll build
  #- bundle exec rake test
  - gulp build

cache: bundler

branches:
  only:
    - master
    - feature/gulp-automate

#sudo: false # route your build to the container-based infrastructure for a faster build

deploy:
  skip_cleanup: true
  provider: cloudfoundry
  edge: true
  api: $CF_API
  username: $CF_USER
  password: $CF_PASS
  organization: $CF_ORG
  space: $CF_SPACE
  appname: $CF_APPNAME
  on:
    branch: master
