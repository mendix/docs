---
title: "Use the Data Importer"
url: /howto/integration/use-the-data-importer/
weight: 21
description: "Overview of the Data Importer in Studio Pro"
#If moving or renaming this doc file, implement a temporary redirect and let the respective team know they should update the URL in the product. See Mapping to Products for more details.
---

## 1 Introduction

Data is constantly exchanged between various systems inside and outside an organization. Microsoft Excel is a common spreadsheet software where data is stored in a tabular grid of rows and columns and has a structure that can be beneficial in your app.

This how-to teaches you to do the following:

* Create a Data Importer document using a sample representative file
* Create a (non-persistable) entity in your domain model
* Import data using the custom **Import data from file** activity

## 2 Prerequisites

Download the [Data Importer extension](https://marketplace.mendix.com/link/component/219833) from the Marketplace and [add it into your app](/appstore/overview/use-content/#install). This module also requires:

* Studio Pro [10.4](/releasenotes/studio-pro/10.4/) or above
* A file document (for more information, see [File Manager](/refguide/file-manager/))

## 3 Design Time Flow

The Data Importer allows you to import an Excel file into your app. Choose which sheet to import data from and which columns you want to include. During the design time flow, you can preview the data and create a non-persistable entity (NPE) in your domain model. 

This module creates a Data Importer document, which you can use along with the **Import data from file** activity. Use this custom activity in a microflow to import data from an Excel file.

### 3.1 Creating a Data Importer Document

Right-click the module you want to add the Data Importer document to and click **Add other** > **Data Importer**.

{{< figure src="/attachments/howto/integration/use-the-data-importer/data-importer-menu.png" >}}

Name the document, then click **OK**, and the new Data Importer document opens.

### 3.2 Previewing Data {#preview-data}

Click **Select a local file** to import an Excel file (*.xls* or *.xslx*).

{{< figure src="/attachments/howto/integration/use-the-data-importer/select-file-for-preview.png" >}}

Select or drop the file in the **Select Source File** field. An Excel workbook can have single or multiple sheets; you can choose which sheet to import data from and specify the header row and starting data row.

* **Sheet Name** – name of the worksheet from where data needs to be imported; if the Excel has multiple worksheets, their names will appear in the dropdown
* **Header Row No.** – row number of the file header; the default is 1
* **Read Data From Row No.** – starting line for reading data; the default is 2

{{< figure src="/attachments/howto/integration/use-the-data-importer/select-sheet-and-header-data-row.png" >}}

Click **Preview Source Data & Entity** to view the data from the file. The first 10 data rows from the source file are shown in the data preview section. If there are less than 10 data rows in the sample file, only the available rows are shown. The column names correspond to the attribute name within the entity, and the sheet name is used to define the entity.

All the columns are automatically selected (checked) for import. You can uncheck the columns you do not want to use. At the bottom of the table, you see the target data type of the attribute, which is based on the cell-type defined in the Excel file's first data row. If any data types are incorrect, check the cell-type of the first data row and adjust the definition accordingly.

{{% alert color="warning" %}} Column names that do not adhere to Mendix naming conventions will be autocorrected. For **Number** cell-types, the target Mendix type is mapped to **Decimal** to accommodate to integers and decimals. {{% /alert %}}

{{< figure src="/attachments/howto/integration/use-the-data-importer/preview-data-and-entity.png" >}}

### 3.3 Creating an Entity {#create-entity}

View the entity in the **Entity Preview** section. You can change the name of the entity, though one is suggested for you based on the sheet name. To create the entity in your domain model, click **Create Entity** > **OK**. You see a confirmation message that an entity has been created in the domain model and is ready to use.

When the entity is created, you can view the mapping of the source Excel columns to the target entity attributes. 

{{< figure src="/attachments/howto/integration/use-the-data-importer/source-to-target-mapping.png" >}}

The Data Importer document creation is complete and can be used to import data in a microflow.

## 4 Building your App {#build-data-importer-app}

At the end of the design time flow, you create a Data Importer document, which allows you to periodically import and validate data from an Excel file that is generated by another app or system. 

### 4.1 Custom Activity {#Import-data-from-file}

The **Import data from file** activity is found under **Integration activities** in the **Toolbox**. Double-click to view its properties:

{{< figure src="/attachments/howto/integration/use-the-data-importer/custom-activity-params.png" >}}

The **Input** section includes:

* **File** – name of the file from which you want to import data
* **Data Importer document** – the Data Importer document created at the end of the design time flow

The **Output** section includes:

* **Return Type** – set to the list of NPEs defined in the Data Importer document
* **Variable name** – auto-populated to the **EntityName** list

### 4.2 Build the Pages

The **Import data from file** custom activity needs an input file to import data from. The example below builds a page where a `System.FileDocument`is uploaded and fed to the custom activity.

1. Open the home page and add a button and name it *Upload Customer Data*.
2. Double-click the button and in the **Events** field under the **On click** drop-down, select **Create object** to create a `System.FileDocument` entity.
3. Pass the control to a new page (**UploadCustomerData**) where the file is uploaded.

{{< figure src="/attachments/howto/integration/use-the-data-importer/home-page-button.png" >}}

4. On the **UploadCustomerData** page, include a data view for the *FileDocument* and include a 'File Manager' to assist with a file upload.

{{< figure src="/attachments/howto/integration/use-the-data-importer/data-view-file-manager.png" >}}

5. Open the **Toolbox** and add a **Call microflow button**. 

6. Click **New** and name the microflow *Import Customer Data*. You also see **FileDocument** in the parameters section; make sure this box is checked to include it as a parameter and click **OK**.

{{< figure src="/attachments/howto/integration/use-the-data-importer/add-parameter.png" >}}

### 4.3 Configuring the Import data from file Activity in a Microflow 

1. In the created microflow, drag the **Import data from file** activity into it. You can find this activity in the **Toolbox** under **Integration activities**.

   {{< figure src="/attachments/howto/integration/use-the-data-importer/integration-activity.png" >}}

2. When the **Import data from file** activity is added into microflow, you see three errors in the console:

   {{< figure src="/attachments/howto/integration/use-the-data-importer/custom-activity.png" >}}

To address these errors, double-click the activity and in the **File** field, choose the input file that is passed from the file upload page to this microflow as a parameter.

3. In the **Data Importer document** field, click **Select** and choose the Data Importer document you want to use.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/choose-data-importer-template.png" >}}

After selecting the Data Importer document, the **Return type** and **Variable name** auto-populates. You can change the name of the output variable if you wish.

4. Click **OK**. The custom activity is configured and all the errors will resolve.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/configured-custom-activity.png" >}}

5. Add an **Aggregate list** activity and configure it to count the size of the 'CustomerList', which is returned from the previous activity.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/aggregate-list.png" >}}

6. Configure a **Show message** activity. You can use a template message and a parameter, such as in the example below.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/show-message-with-list-size.png" >}}

7. Set '$CustomerList' as the return value from the **Import data from file** activity to be used later. Your completed microflow should look like the image below.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/example-microflow.png" >}}

8. Deploy your app locally. Browse and upload an input file, which is similar to the file that was used as a template while creating Data Importer document.
9. Check that you see a message that states **Imported xx rows from input file into a list of NPEs**.

  {{< figure src="/attachments/howto/integration/use-the-data-importer/local-app-run.png" >}}

You have successfully configured and used the Data Importer extension. You can extend this as per your requirements. For example, you can convert the list of NPEs into persistable entities by providing a message definition, or use each loop construct and individually create and commit entities into your database.
